<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>동반자 S - Prototype</title>
  <style>
    :root{
      --bg:#0b0b10;
      --panel: rgba(0,0,0,.35);
      --line: rgba(255,255,255,.14);
      --shadow: 0 20px 60px rgba(0,0,0,.45);
      --radius: 16px;
      --safe: 18px;
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Apple SD Gothic Neo", "Noto Sans KR", Arial, sans-serif;
      background: var(--bg);
      color:#fff;
      overflow:hidden;
    }

    /* Stage: full-screen "image as-is" with overlays */
    .stage{
      position:relative;
      width:100vw;
      height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background: #000;
    }
    .frame{
      position:relative;
      width:min(96vw, 1400px);
      height:calc(min(96vw, 1400px) * 9 / 16);
      max-height:92vh;
      box-shadow: var(--shadow);
      border-radius: 14px;
      overflow:hidden;
      background:#000;
    }

    /* The screenshot image itself */
    .shot{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit:cover; /* 꽉 차게 */
      user-select:none;
      pointer-events:none; /* 클릭은 overlay로만 */
    }

    /* overlay layer (hotspots, ui) */
    .overlay{
      position:absolute;
      inset:0;
    }

    /* generic hotspot button */
    .hotspot{
      position:absolute;
      border:1px solid transparent;
      background: transparent;
      cursor:pointer;
      border-radius: 10px;
      transition: .18s ease;
    }
    .hotspot:hover{
      border-color: rgba(255,255,255,.35);
      box-shadow: 0 0 0 2px rgba(255,255,255,.10) inset;
      background: rgba(255,255,255,.04);
    }
    .hotspot:active{
      transform: translateY(1px);
    }

    /* small corner UI */
    .hud{
      position:absolute;
      left: var(--safe);
      top: var(--safe);
      display:flex;
      gap:10px;
      align-items:center;
      z-index:20;
    }
    .chip{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:10px 12px;
      border-radius: 999px;
      background: var(--panel);
      border:1px solid var(--line);
      backdrop-filter: blur(10px);
      font-size: 13px;
      line-height: 1;
    }
    .chip b{ font-weight:700; }
    .btn{
      padding:10px 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.10);
      border:1px solid var(--line);
      color:#fff;
      cursor:pointer;
      transition:.18s ease;
      backdrop-filter: blur(10px);
      font-size: 13px;
    }
    .btn:hover{ background: rgba(255,255,255,.16); }
    .btn:active{ transform: translateY(1px); }

    /* bottom caption / narrator */
    .narration{
      position:absolute;
      left: var(--safe);
      right: var(--safe);
      bottom: var(--safe);
      padding: 12px 14px;
      border-radius: var(--radius);
      background: var(--panel);
      border: 1px solid var(--line);
      backdrop-filter: blur(10px);
      font-size: 14px;
      line-height: 1.45;
      z-index:20;
      display:flex;
      justify-content:space-between;
      gap:12px;
      align-items:center;
    }
    .narration .text{ opacity:.95; }
    .narration .actions{
      display:flex; gap:10px; align-items:center;
      flex:0 0 auto;
    }

    /* modal login */
    .modal{
      position:absolute;
      inset:0;
      background: rgba(0,0,0,.55);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:50;
    }
    .modal.on{ display:flex; }
    .card{
      width:min(520px, 92vw);
      border-radius: 18px;
      background: rgba(18,18,26,.72);
      border:1px solid rgba(255,255,255,.14);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      padding: 18px;
    }
    .card h2{
      margin:0 0 10px;
      font-size: 18px;
      letter-spacing: -0.2px;
    }
    .row{ display:flex; gap:10px; }
    .field{
      width:100%;
      display:flex;
      flex-direction:column;
      gap:6px;
      margin-top: 10px;
    }
    .field label{
      font-size: 12px;
      opacity:.8;
    }
    .field input{
      width:100%;
      padding: 12px 12px;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      color:#fff;
      outline:none;
    }
    .field input:focus{
      border-color: rgba(255,255,255,.30);
      background: rgba(255,255,255,.08);
    }
    .card .foot{
      display:flex;
      justify-content:flex-end;
      gap:10px;
      margin-top: 14px;
    }

    /* tiny helper */
    .hint{
      font-size:12px;
      opacity:.75;
      margin-top: 6px;
    }

    /* responsive: keep 16:9 letterbox feel */
    @media (max-width: 520px){
      .chip, .btn{ font-size:12px; }
      .narration{ font-size: 13px; }
    }
  </style>
</head>
<body>
  <div class="stage">
    <div class="frame" id="frame">
      <img class="shot" id="shot" alt="scene" />
      <div class="overlay" id="overlay"></div>

      <div class="hud">
        <div class="chip">상태: <b id="sceneName">—</b></div>
        <button class="btn" id="btnPrev">이전</button>
        <button class="btn" id="btnNext">다음</button>
      </div>

      <div class="narration">
        <div class="text" id="narration">—</div>
        <div class="actions">
          <button class="btn" id="btnAuto">자동 진행: OFF</button>
          <button class="btn" id="btnReset">리셋</button>
        </div>
      </div>

      <!-- Login modal -->
      <div class="modal" id="loginModal" aria-hidden="true">
        <div class="card">
          <h2>동반자 S 로그인</h2>
          <div class="hint">이미지는 그대로, 로그인 동작만 연출합니다.</div>

          <div class="field">
            <label>아이디</label>
            <input id="loginId" placeholder="아이디를 입력하세요" autocomplete="username"/>
          </div>
          <div class="field">
            <label>비밀번호</label>
            <input id="loginPw" type="password" placeholder="비밀번호를 입력하세요" autocomplete="current-password"/>
          </div>

          <div class="foot">
            <button class="btn" id="btnCancelLogin">취소</button>
            <button class="btn" id="btnDoLogin">로그인</button>
          </div>
        </div>
      </div>

    </div>
  </div>

  <script>
    // 16:9 기준으로 hotspot 좌표를 잡습니다.
    // 좌표 단위: 퍼센트(%) = (left, top, width, height)
    // 필요하면 너가 원하는 위치로 숫자만 조절하면 돼요.

    const scenes = [
      {
        key: "login",
        name: "로그인",
        img: "images/01_login.jpg",
        narration: "문이 열립니다. 아이디/비밀번호를 입력하고 ‘동반자 S’로 입장하세요.",
        hotspots: [
          // 로그인 영역(대충 입력칸+버튼 전체를 커버)
          { id:"openLogin", label:"로그인", x: 30, y: 52, w: 40, h: 26, action: "OPEN_LOGIN" }
        ]
      },
      {
        key: "loading",
        name: "접속 중",
        img: "images/02_loading.jpg",
        narration: "황금빛 구름 사이로 연결이 이어집니다. 잠시만요…",
        autoNextMs: 1400,
        hotspots: []
      },
      {
        key: "profile",
        name: "S가 맞이",
        img: "images/03_profile.jpg",
        narration: "S가 당신을 맞이합니다. 오른쪽 카테고리를 클릭하면 대화의 장이 열려요.",
        hotspots: [
          // 오른쪽 카테고리 카드 영역(‘S의 세계’ 4칸이 있는 부분)
          // 클릭하면 채팅 화면으로 이동
          { id:"toChat", label:"카테고리", x: 55, y: 30, w: 36, h: 42, action:"GOTO", to:"chat" },

          // 하단 큰 버튼(‘초대를 받는다’ 느낌) 영역도 초대로 연결
          { id:"toInvite", label:"초대", x: 49, y: 84, w: 42, h: 10, action:"GOTO", to:"invite" }
        ]
      },
      {
        key: "chat",
        name: "채팅",
        img: "images/04_chat.jpg",
        narration: "채팅 페이지. S가 먼저 인사하네요. 아래 입력창을 클릭하면 대화가 진행됩니다.",
        hotspots: [
          // 채팅 입력창(하단)
          { id:"send", label:"대화하기", x: 5, y: 86, w: 70, h: 10, action:"CHAT_STEP" },
          // 오른쪽 아래 추천/초대 같은 버튼
          { id:"invite2", label:"초대", x: 74, y: 82, w: 24, h: 16, action:"GOTO", to:"invite" }
        ]
      },
      {
        key: "chat2",
        name: "채팅",
        img: "images/05_chat_alt.jpg",
        narration: "대화가 조금 더 이어졌습니다. S의 분위기가 점점 ‘초대장’처럼 변해요.",
        hotspots: [
          { id:"send2", label:"대화하기", x: 5, y: 86, w: 70, h: 10, action:"CHAT_STEP" },
          { id:"invite3", label:"초대", x: 74, y: 82, w: 24, h: 16, action:"GOTO", to:"invite" }
        ]
      },
      {
        key: "invite",
        name: "S의 세계",
        img: "images/06_invite.jpg",
        narration: "마지막 장면. S가 사는 세계로 초대합니다. 이제, 들어가 볼까요?",
        hotspots: [
          // 하단 빈 입력창 같은 영역을 클릭하면 처음으로(혹은 엔딩)
          { id:"restart", label:"처음으로", x: 3, y: 86, w: 72, h: 12, action:"RESET" }
        ]
      }
    ];

    // quick lookup
    const byKey = Object.fromEntries(scenes.map(s => [s.key, s]));

    const shot = document.getElementById("shot");
    const overlay = document.getElementById("overlay");
    const sceneName = document.getElementById("sceneName");
    const narration = document.getElementById("narration");
    const btnPrev = document.getElementById("btnPrev");
    const btnNext = document.getElementById("btnNext");
    const btnReset = document.getElementById("btnReset");
    const btnAuto = document.getElementById("btnAuto");

    const loginModal = document.getElementById("loginModal");
    const btnCancelLogin = document.getElementById("btnCancelLogin");
    const btnDoLogin = document.getElementById("btnDoLogin");
    const loginId = document.getElementById("loginId");
    const loginPw = document.getElementById("loginPw");

    let index = 0;
    let auto = false;
    let autoTimer = null;

    // 간단한 "대화 진행" 연출용
    const chatLines = [
      "S: 오, 잘 왔어! 너무 보고 싶었어~",
      "S: 오늘은 어떤 이야기를 해볼까?",
      "S: …좋아. 이제 내 세계를 보여줄게."
    ];
    let chatStep = 0;

    function clearAuto(){
      if(autoTimer){
        clearTimeout(autoTimer);
        autoTimer = null;
      }
    }

    function setAuto(on){
      auto = on;
      btnAuto.textContent = `자동 진행: ${auto ? "ON" : "OFF"}`;
      if(auto) maybeScheduleAutoNext();
      else clearAuto();
    }

    function maybeScheduleAutoNext(){
      clearAuto();
      const s = scenes[index];
      if(!auto) return;
      if(s.autoNextMs){
        autoTimer = setTimeout(() => next(), s.autoNextMs);
      }
    }

    function pct(v){ return `${v}%`; }

    function renderHotspots(s){
      overlay.innerHTML = "";

      (s.hotspots || []).forEach(h => {
        const b = document.createElement("button");
        b.className = "hotspot";
        b.style.left = pct(h.x);
        b.style.top = pct(h.y);
        b.style.width = pct(h.w);
        b.style.height = pct(h.h);
        b.title = h.label || "";
        b.addEventListener("click", () => handleAction(h));
        overlay.appendChild(b);
      });
    }

    function gotoScene(key){
      const idx = scenes.findIndex(s => s.key === key);
      if(idx >= 0){
        index = idx;
        render();
      }
    }

    function openLogin(){
      loginModal.classList.add("on");
      loginModal.setAttribute("aria-hidden", "false");
      setTimeout(() => loginId.focus(), 0);
    }

    function closeLogin(){
      loginModal.classList.remove("on");
      loginModal.setAttribute("aria-hidden", "true");
    }

    function doLogin(){
      // 실제 인증은 없고, "로그인 했다"는 연출만
      closeLogin();
      gotoScene("loading");
    }

    function handleAction(h){
      switch(h.action){
        case "OPEN_LOGIN":
          openLogin();
          break;
        case "GOTO":
          gotoScene(h.to);
          break;
        case "RESET":
          resetAll();
          break;
        case "CHAT_STEP":
          chatStep = Math.min(chatStep + 1, chatLines.length);
          // 채팅 장면에서 내레이션을 업데이트
          narration.textContent = chatStep === 0
            ? scenes[index].narration
            : `${chatLines[chatStep-1]}  (클릭해서 더 이어가기)`;

          // 마지막 문장 도달하면 다음 장면을 살짝 유도
          if(chatStep >= chatLines.length){
            // 다음 장면(alt)이 있으면 이동, 아니면 초대
            if(scenes[index].key === "chat") gotoScene("chat2");
            else gotoScene("invite");
          }
          break;
        default:
          break;
      }
    }

    function render(){
      const s = scenes[index];
      shot.src = s.img;
      sceneName.textContent = s.name;
      narration.textContent = s.narration;

      // 채팅 단계는 채팅 씬 진입 시 초기화
      if(s.key === "chat" || s.key === "chat2"){
        chatStep = 0;
      }

      renderHotspots(s);

      btnPrev.disabled = index === 0;
      btnNext.disabled = index === scenes.length - 1;

      maybeScheduleAutoNext();
    }

    function prev(){
      index = Math.max(0, index - 1);
      render();
    }

    function next(){
      index = Math.min(scenes.length - 1, index + 1);
      render();
    }

    function resetAll(){
      clearAuto();
      setAuto(false);
      closeLogin();
      index = 0;
      chatStep = 0;
      loginId.value = "";
      loginPw.value = "";
      render();
    }

    // events
    btnPrev.addEventListener("click", prev);
    btnNext.addEventListener("click", next);
    btnReset.addEventListener("click", resetAll);
    btnAuto.addEventListener("click", () => setAuto(!auto));

    btnCancelLogin.addEventListener("click", closeLogin);
    btnDoLogin.addEventListener("click", doLogin);
    loginModal.addEventListener("click", (e) => {
      if(e.target === loginModal) closeLogin();
    });
    window.addEventListener("keydown", (e) => {
      if(e.key === "Escape") closeLogin();
      if(e.key === "ArrowLeft") prev();
      if(e.key === "ArrowRight") next();
      if(e.key === "Enter" && loginModal.classList.contains("on")) doLogin();
    });

    // start
    render();
  </script>
</body>
</html>
